$excludePatterns = @('node_modules', '.git', '__pycache__', 'dist', 'build'); $itemsToZip = Get-ChildItem -Recurse | Where-Object { $exclude = $false; foreach ($pattern in $excludePatterns) { if ($_.FullName -match $pattern) { $exclude = $true; break } }; !$exclude }; Compress-Archive -Path $itemsToZip.FullName -DestinationPath nexus-cos-vps-deploy.zip -Force; Write-Host 'Zip created successfully.'