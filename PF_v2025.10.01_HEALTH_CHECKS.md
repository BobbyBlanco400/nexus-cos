# Nexus COS PF v2025.10.01 - Health Check Configuration

**Status:** LIVE | CERTIFIED | PF-SYNC READY  
**Version:** v2025.10.01  
**Last Updated:** 2025-10-01 23:22 PST  

---

## Health Check Endpoints

This document defines all health check endpoints for PF v2025.10.01 services.

### Core Platform Services

| Service | Endpoint | Port | Expected Response |
|---------|----------|------|-------------------|
| Core API Gateway | `https://nexuscos.online/api/health` | 4000 | HTTP 200 + JSON status |
| Gateway Health | `https://nexuscos.online/health/gateway` | - | HTTP 200 |

### PUABO NEXUS Services (Box Truck & Fleet Ecosystem)

| Service | Endpoint | Port | Expected Response |
|---------|----------|------|-------------------|
| AI Dispatch | `https://nexuscos.online/puabo-nexus/dispatch/health` | 3231 | HTTP 200 + JSON status |
| Driver App Backend | `https://nexuscos.online/puabo-nexus/driver/health` | 3232 | HTTP 200 + JSON status |
| Fleet Manager | `https://nexuscos.online/puabo-nexus/fleet/health` | 3233 | HTTP 200 + JSON status |
| Route Optimizer | `https://nexuscos.online/puabo-nexus/routes/health` | 3234 | HTTP 200 + JSON status |

### V-Suite Services

| Service | Endpoint | Port | Expected Response |
|---------|----------|------|-------------------|
| VScreen Hollywood | `https://nexuscos.online/v-suite/screen/health` | 8088 | HTTP 200 + JSON status |
| V-Prompter Pro | `https://nexuscos.online/v-suite/prompter/health` | 3011 | HTTP 200 + JSON status |

### Media & Entertainment

| Service | Endpoint | Port | Expected Response |
|---------|----------|------|-------------------|
| Nexus Studio AI | `https://nexuscos.online/nexus-studio/health` | 3006 | HTTP 200 + JSON status |
| Club Saditty | `https://nexuscos.online/club-saditty/health` | 3007 | HTTP 200 + JSON status |
| PUABO DSP | `https://nexuscos.online/puabo-dsp/health` | 3003 | HTTP 200 + JSON status |
| PUABO BLAC | `https://nexuscos.online/puabo-blac/health` | 3005 | HTTP 200 + JSON status |

### Authentication & Payment

| Service | Endpoint | Port | Expected Response |
|---------|----------|------|-------------------|
| Nexus ID OAuth | `https://nexuscos.online/auth/health` | 3001 | HTTP 200 + JSON status |
| Nexus Pay Gateway | `https://nexuscos.online/payment/health` | 3008 | HTTP 200 + JSON status |

### Infrastructure Services

| Service | Internal Endpoint | Port | Expected Response |
|---------|-------------------|------|-------------------|
| PostgreSQL | `nexus-cos-postgres:5432` | 5432 | Connection successful |
| Redis | `nexus-cos-redis:6379` | 6379 | PONG response |

---

## Health Check Response Format

All services should return a JSON response in the following format:

```json
{
  "status": "ok",
  "service": "service-name",
  "version": "1.0.0",
  "port": "3231",
  "timestamp": "2025-10-01T23:22:00.000Z",
  "dependencies": {
    "database": "connected",
    "cache": "connected"
  }
}
```

---

## Automated Health Check Script

Use the following script to check all health endpoints:

```bash
#!/bin/bash

# Health Check Script for PF v2025.10.01

DOMAIN="nexuscos.online"

echo "Checking Nexus COS PF v2025.10.01 Health Endpoints..."
echo ""

# Core Services
echo "Core Services:"
curl -I -s "https://${DOMAIN}/api/health" | head -1
curl -I -s "https://${DOMAIN}/health/gateway" | head -1
echo ""

# PUABO NEXUS Services
echo "PUABO NEXUS Services:"
curl -I -s "https://${DOMAIN}/puabo-nexus/dispatch/health" | head -1
curl -I -s "https://${DOMAIN}/puabo-nexus/driver/health" | head -1
curl -I -s "https://${DOMAIN}/puabo-nexus/fleet/health" | head -1
curl -I -s "https://${DOMAIN}/puabo-nexus/routes/health" | head -1
echo ""

# V-Suite Services
echo "V-Suite Services:"
curl -I -s "https://${DOMAIN}/v-suite/screen/health" | head -1
curl -I -s "https://${DOMAIN}/v-suite/prompter/health" | head -1
echo ""

# Media & Entertainment
echo "Media & Entertainment:"
curl -I -s "https://${DOMAIN}/nexus-studio/health" | head -1
curl -I -s "https://${DOMAIN}/club-saditty/health" | head -1
curl -I -s "https://${DOMAIN}/puabo-dsp/health" | head -1
curl -I -s "https://${DOMAIN}/puabo-blac/health" | head -1
echo ""

# Auth & Payment
echo "Authentication & Payment:"
curl -I -s "https://${DOMAIN}/auth/health" | head -1
curl -I -s "https://${DOMAIN}/payment/health" | head -1
echo ""
```

Save this as `check-pf-v2025-health.sh` and run with:

```bash
chmod +x check-pf-v2025-health.sh
./check-pf-v2025-health.sh
```

---

## Internal Health Checks (Docker Compose)

### Check Service Status

```bash
docker compose -f docker-compose.pf.yml ps
```

Expected output: All services should show "Up" status

### Check Specific Service Health

```bash
# Check PUABO NEXUS AI Dispatch
docker compose -f docker-compose.pf.yml exec puabo-nexus-ai-dispatch curl -f http://localhost:3231/health

# Check Driver App Backend
docker compose -f docker-compose.pf.yml exec puabo-nexus-driver-app-backend curl -f http://localhost:3232/health

# Check Fleet Manager
docker compose -f docker-compose.pf.yml exec puabo-nexus-fleet-manager curl -f http://localhost:3233/health

# Check Route Optimizer
docker compose -f docker-compose.pf.yml exec puabo-nexus-route-optimizer curl -f http://localhost:3234/health
```

### Check Database Connectivity

```bash
# PostgreSQL
docker compose -f docker-compose.pf.yml exec nexus-cos-postgres \
  psql -U nexus_user -d nexus_db -c "SELECT 1;"

# Redis
docker compose -f docker-compose.pf.yml exec nexus-cos-redis redis-cli ping
```

---

## Monitoring & Alerting

### Recommended Monitoring Setup

1. **External Monitoring (Uptime Robot / Pingdom)**
   - Monitor all public health endpoints
   - Alert threshold: 2 consecutive failures
   - Check interval: 5 minutes

2. **Internal Monitoring (Prometheus + Grafana)**
   - Scrape health endpoints every 30 seconds
   - Track response times
   - Monitor resource usage (CPU, Memory, Disk)

3. **Log Aggregation (ELK Stack / Loki)**
   - Centralize logs from all services
   - Alert on ERROR level logs
   - Track request patterns

### Alert Conditions

Configure alerts for:

- **Service Down:** Health check returns non-200 status
- **High Latency:** Response time > 2 seconds
- **Database Issues:** Connection errors or slow queries
- **Cache Issues:** Redis connection failures
- **Disk Space:** < 10% free space
- **Memory:** > 85% usage

---

## Troubleshooting Health Check Failures

### Service Not Responding

```bash
# Check service logs
docker compose -f docker-compose.pf.yml logs -f <service-name>

# Restart service
docker compose -f docker-compose.pf.yml restart <service-name>

# Check if service is running
docker compose -f docker-compose.pf.yml ps <service-name>
```

### Database Connection Issues

```bash
# Check PostgreSQL status
docker compose -f docker-compose.pf.yml ps nexus-cos-postgres

# View PostgreSQL logs
docker compose -f docker-compose.pf.yml logs nexus-cos-postgres

# Test connection
docker compose -f docker-compose.pf.yml exec nexus-cos-postgres \
  pg_isready -U nexus_user -d nexus_db
```

### Redis Connection Issues

```bash
# Check Redis status
docker compose -f docker-compose.pf.yml ps nexus-cos-redis

# View Redis logs
docker compose -f docker-compose.pf.yml logs nexus-cos-redis

# Test connection
docker compose -f docker-compose.pf.yml exec nexus-cos-redis redis-cli ping
```

### Network Issues

```bash
# Check Docker networks
docker network ls

# Inspect network
docker network inspect nexus-cos_cos-net

# Check if services can communicate
docker compose -f docker-compose.pf.yml exec puabo-api \
  curl -f http://nexus-cos-postgres:5432
```

---

## Health Check Best Practices

1. **Implement Graceful Degradation**
   - Services should report degraded status if dependencies are down
   - Continue serving cached data when possible

2. **Include Dependency Checks**
   - Health endpoint should verify database connectivity
   - Check cache availability
   - Validate external API connections

3. **Return Detailed Information**
   - Include version number
   - Report uptime
   - List dependency statuses
   - Include timestamp

4. **Use Appropriate Status Codes**
   - 200: Service fully healthy
   - 503: Service unavailable
   - 500: Internal error

5. **Implement Startup Probes**
   - Allow time for service initialization
   - Don't fail health checks during startup
   - Use Docker `start_period` configuration

6. **Monitor Health Check Performance**
   - Health checks should be fast (< 1 second)
   - Don't perform heavy operations
   - Cache health status if needed

---

## Integration with CI/CD

### Pre-Deployment Health Check

Before deploying new version:

```bash
# Run health check validation
./validate-pf-v2025.10.01.sh

# Verify all services are healthy
./check-pf-v2025-health.sh
```

### Post-Deployment Verification

After deployment:

```bash
# Wait for services to start (60 seconds)
sleep 60

# Run health checks
./check-pf-v2025-health.sh

# If any failures, rollback
if [ $? -ne 0 ]; then
    echo "Health check failed, rolling back..."
    docker compose -f docker-compose.pf.yml down
    # Restore previous version
fi
```

---

## Contact & Support

- **Documentation:** `/home/runner/work/nexus-cos/nexus-cos/PF_v2025.10.01.md`
- **GitHub:** https://github.com/BobbyBlanco400/nexus-cos
- **PF Version:** v2025.10.01
- **Status:** LIVE | CERTIFIED | PF-SYNC READY

---

**END OF DOCUMENT**
