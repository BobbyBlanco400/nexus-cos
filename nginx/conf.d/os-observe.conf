add_header X-N3XUS-OS "v-COS";
add_header X-N3XUS-Version "v-COS-G0";
add_header X-N3XUS-Billing-Mode "observe-only";

# Forward billing headers with consistent naming
proxy_set_header X-N3XUS-Billing-State $http_x_n3xus_billing_state;
proxy_set_header X-N3XUS-Plan $http_x_n3xus_plan;
proxy_set_header X-N3XUS-Split $http_x_n3xus_split;
proxy_set_header X-N3XUS-Role $http_x_n3xus_role;

log_format nexus '$remote_addr [$time_local] '
                '"$request" $status '
                'billing=$http_x_n3xus_billing_state '
                'plan=$http_x_n3xus_plan '
                'role=$http_x_n3xus_role';

access_log /var/log/nginx/nexus-os.log nexus;
